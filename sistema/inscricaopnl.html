<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pr√©-inscri√ß√£o</title>

<style>
* { box-sizing: border-box; }

body {
  font-family: Arial, sans-serif;
  background: #f4f6f8;
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
}

.card {
  background: #fff;
  padding: 25px;
  max-width: 420px;
  width: 100%;
  border-radius: 12px;
  box-shadow: 0 8px 20px rgba(0,0,0,.1);
}

input, select, button {
  width: 100%;
  padding: 14px;
  margin-bottom: 12px;
  border-radius: 10px;
  border: 1px solid #ccc;
}

input.erro {
  border-color: red;
}

button {
  background: linear-gradient(135deg, #1f3c88, #2f55d4);
  color: #fff;
  border: none;
  font-weight: bold;
  cursor: pointer;
}

button:disabled {
  opacity: .6;
  cursor: not-allowed;
}
</style>
</head>

<body>

<div class="card" id="formCard">

  <h2>Pr√©-inscri√ß√£o</h2>
  <p style="font-size:14px; margin-bottom:15px;">
    Preencha seus dados para reservar sua vaga.
    A confirma√ß√£o ocorre ap√≥s o pagamento.
  </p>

  <input id="nome" placeholder="Seu nome completo">
  <input id="cpf" placeholder="CPF (somente n√∫meros)">
  <input id="email" placeholder="Seu melhor e-mail">
  <input id="telefone" placeholder="Telefone / WhatsApp">

  <input id="curso" placeholder="Curso de interesse">
  <input id="turma" placeholder="Turma (se houver)">

  <select id="pais">
    <option value="">Pa√≠s</option>
    <option value="BR">Brasil</option>
    <option value="JP">Jap√£o</option>
    <option value="PY">Paraguai</option>
  </select>

  <input id="estado" placeholder="Estado / Regi√£o">
  <input id="cidade" placeholder="Cidade">

  <button id="btnConfirmar" onclick="finalizar()">
    CONFIRMAR PR√â-INSCRI√á√ÉO
  </button>

</div>

<script src="/js/igc-config.js"></script>

<script>
const ENDPOINT = window.IGC_CONFIG.APPS_SCRIPT_BASE;

const nomeEl = document.getElementById("nome");
const cpfEl = document.getElementById("cpf");
const emailEl = document.getElementById("email");
const telefoneEl = document.getElementById("telefone");
const cursoEl = document.getElementById("curso");
const turmaEl = document.getElementById("turma");
const paisEl = document.getElementById("pais");
const estadoEl = document.getElementById("estado");
const cidadeEl = document.getElementById("cidade");
const btnConfirmar = document.getElementById("btnConfirmar");

cpfEl.oninput = e =>
  e.target.value = e.target.value.replace(/\D/g,'').slice(0,11);

telefoneEl.oninput = e =>
  e.target.value = e.target.value.replace(/\D/g,'');

emailEl.oninput = e =>
  e.target.value = e.target.value.toLowerCase();

function finalizar() {

  if (!nomeEl.value.trim()) return alert("Informe o nome.");
  if (!emailEl.value.trim()) return alert("Informe o e-mail.");
  if (!telefoneEl.value.trim()) return alert("Informe o telefone.");
  if (!cursoEl.value.trim()) return alert("Informe o curso.");

  btnConfirmar.disabled = true;
  btnConfirmar.innerText = "Registrando pr√©-inscri√ß√£o...";

  fetch(ENDPOINT, {
    method: "POST",
    body: JSON.stringify({

      // üîë BIFURCA√á√ÉO DO SISTEMA
      tipo: "PRE",

      nome: nomeEl.value.toUpperCase(),
      cpf: cpfEl.value,
      email: emailEl.value,
      telefone: telefoneEl.value,

      nomeCurso: cursoEl.value.toUpperCase(),
      turma: turmaEl.value.toUpperCase(),

      pais: paisEl.value,
      estado: estadoEl.value.toUpperCase(),
      cidade: cidadeEl.value.toUpperCase()
    })
  })
  .then(r => r.json())
  .then(res => {

    if (!res.sucesso) {
      alert("Erro ao registrar a pr√©-inscri√ß√£o.");
      btnConfirmar.disabled = false;
      btnConfirmar.innerText = "CONFIRMAR PR√â-INSCRI√á√ÉO";
      return;
    }

    document.body.innerHTML = `
      <div style="
        background:#f4f6f8;
        min-height:100vh;
        display:flex;
        align-items:center;
        justify-content:center;
        padding:20px;
        text-align:center;
      ">
        <div style="
          background:#fff;
          padding:30px;
          border-radius:12px;
          max-width:420px;
          box-shadow:0 8px 20px rgba(0,0,0,.1);
        ">
          <h2 style="color:#1f3c88;">üìù Pr√©-inscri√ß√£o recebida!</h2>
          <p style="margin-top:15px;">
            Seus dados foram registrados com sucesso.<br><br>
            Para confirmar sua vaga, finalize o pagamento conforme
            instru√ß√µes combinadas.
          </p>
          <p style="margin-top:20px;">
            Ap√≥s a confirma√ß√£o do pagamento,
            voc√™ receber√° todas as informa√ß√µes por e-mail.
          </p>
        </div>
      </div>
    `;
  });
}
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Inscri√ß√£o</title>

<style>
* { box-sizing: border-box; }
body {
  font-family: Arial, sans-serif;
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;

/* üî• BACKGROUND RESPONSIVO */
  background-image: url("/assets/imginscricao/inscricaopnlcuritiba.jpg");
  background-size: cover;        /* cobre toda a tela */
  background-position: center;   /* centraliza */
  background-repeat: no-repeat;  /* n√£o repete */
  background-attachment: fixed;  /* desktop bonito */




  
}

.card {
  display: block;
  background: #fff;
  padding: 25px;
  max-width: 420px;
  width: 100%;
  border-radius: 12px;
  box-shadow: 0 8px 20px rgba(0,0,0,.1);
}

.loader {
  font-size: 18px;
  color: #1f3c88;
}

input, select, button {
  width: 100%;
  padding: 14px;
  margin-bottom: 12px;
  border-radius: 10px;
  border: 1px solid #ccc;
}

input.erro {
  border-color: red;
}

button {
  background: linear-gradient(135deg, #1f3c88, #2f55d4);
  color: #fff;
  border: none;
  font-weight: bold;
}

button,
.btn {
  transition: 
    transform 0.1s ease,
    box-shadow 0.1s ease,
    opacity 0.2s ease;
}

button:active,
.btn:active {
  transform: scale(0.96);
  box-shadow: 0 2px 6px rgba(0,0,0,.2) inset;
  opacity: 0.85;
}


@keyframes fadeIn {
  from { opacity: 0; transform: scale(.95); }
  to { opacity: 1; transform: scale(1); }
}


.dados-inscricao p {
    margin: 3px 0;
    line-height: 1.25;
    font-size: 15px;
  }
  
  
</style>
</head>


<div class="card" id="formCard">
  <h2 id="titulo" style="text-align:center;">üìù Ficha de Pr√©-Inscri√ß√£o</h2>
  
  <p style="font-size:15px; text-align:center;">Forma√ß√£o em PNL - Programa√ß√£o Neurolingu√≠stica - Edi√ß√£o Curitiba/PR - De 10 √† 12/04/2026</p>


  
  
  <input id="nome" placeholder="Seu Nome Completo">
  <input id="cpf" placeholder="CPF (somente n√∫meros)">
  <input id="email" placeholder="Seu Melhor E-mail">
  <input id="telefone" placeholder="Telefone/WhatsApp">
  


<select id="pais">
  <option value="">Pa√≠s</option>
  <option value="BR">Brasil</option>
  <option value="JP">Jap√£o</option>
  <option value="PY">Paraguai</option>
</select>


  
<select id="estado" disabled>
  <option value="">Estado / Regi√£o</option>
</select>

<input
  id="estadoOutro"
  placeholder="Digite o estado / regi√£o"
  style="display:none">


<select id="cidade" disabled>
  <option value="">Cidade</option>
</select>

<input
  id="cidadeOutra"
  placeholder="Digite a cidade"
  style="display:none"
>

<button id="btnConfirmar" onclick="finalizar()">CONFIRMAR ENVIO</button>
</div>

<script src="/js/localidades.js"></script>

<script src="/js/igc-config.js"></script>  
  
<script>

const LINK_PAGAMENTO = "https://mpago.la/1U1TPB1";
const ENDPOINT = window.IGC_CONFIG.APPS_SCRIPT_BASE;




  

  
const CURSO_FIXO = "FORMA√á√ÉO EM PNL - PROGRAMA√á√ÉO NEUROLINGU√çSTICA"; // ‚¨ÖÔ∏è EXATAMENTE como est√° no Excel
const TURMA_FIXA = "ABR 26 CUR-03"; // exatamente como est√° na planilha


  
/* ===========================
   üîΩ CARREGA CURSOS ATIVOS
   =========================== */

let CURSOS_MAPA = {};

  
window.onload = () => {
  fetch(`${ENDPOINT}?acao=listarCursos`)
    .then(r => r.json())
    .then(cursos => {

      cursos
        .filter(c => c.ativo === true)
        .forEach(curso => {

          const nome = (curso.nome || "").trim();
          const turma = (curso.turma || "").trim();
          const chave = `${nome}__${turma}`;

          CURSOS_MAPA[chave] = curso;
        });

    })
    .catch(err => {
      console.warn("Falha ao carregar cursos:", err);
    });
};


   

// ===== VALIDA√á√ïES =====

const nomeEl = document.getElementById("nome");
const cpfEl = document.getElementById("cpf");
const emailEl = document.getElementById("email");
const telefoneEl = document.getElementById("telefone");
const paisEl = document.getElementById("pais");
const estadoEl = document.getElementById("estado");
const cidadeEl = document.getElementById("cidade");
const cidadeOutraEl = document.getElementById("cidadeOutra");
const estadoOutroEl = document.getElementById("estadoOutro");
const btnConfirmar = document.getElementById("btnConfirmar");  


  

nomeEl.oninput = e => e.target.value = e.target.value.replace(/[^A-Za-z√Ä-√ø ]/g,'').toUpperCase();
cidadeEl.oninput = e => e.target.value = e.target.value.replace(/[^A-Za-z√Ä-√ø ]/g,'').toUpperCase();
telefoneEl.oninput = e => e.target.value = e.target.value.replace(/\D/g,'');
cpfEl.oninput = e => {
  e.target.value = e.target.value.replace(/\D/g, '').slice(0, 11);
};

  estadoOutroEl.oninput = e => {e.target.value = e.target.value.replace(/[^A-Za-z√Ä-√ø ]/g,'').toUpperCase();
};
  
cidadeOutraEl.oninput = e => {e.target.value = e.target.value.replace(/[^A-Za-z√Ä-√ø ]/g,'').toUpperCase();
};
  

cpfEl.onblur = () => cpfEl.classList.toggle("erro", !validarCPF(cpfEl.value));
emailEl.oninput = e => {
  e.target.value = e.target.value.toLowerCase();
};

emailEl.onblur = () => {
  emailEl.classList.toggle(
    "erro",
    !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(emailEl.value)
  );
};

function validarCPF(cpf) {
  cpf = cpf.replace(/\D/g,'');
  if (cpf.length !== 11 || /^(\d)\1+$/.test(cpf)) return false;
  let soma = 0, resto;
  for (let i=1;i<=9;i++) soma += parseInt(cpf[i-1])*(11-i);
  resto = (soma*10)%11;
  if (resto===10) resto=0;
  if (resto!=cpf[9]) return false;
  soma=0;
  for (let i=1;i<=10;i++) soma += parseInt(cpf[i-1])*(12-i);
  resto = (soma*10)%11;
  if (resto===10) resto=0;
  return resto==cpf[10];
}



 paisEl.onchange = () => {

  // üîπ define o r√≥tulo correto conforme o pa√≠s
  estadoEl.innerHTML =
    paisEl.value === "JP"
      ? `<option value="">Prefeitura</option>`
      : paisEl.value === "PY"
      ? `<option value="">Departamento</option>`
      : `<option value="">Estado</option>`;


// üîπ r√≥tulo da CIDADE conforme o pa√≠s
cidadeEl.placeholder =
  paisEl.value === "JP"
    ? "Â∏Ç (Cidade)"
    : paisEl.value === "PY"
    ? "Ciudad"
    : "Cidade";
   

  estadoEl.disabled = true;
  cidadeEl.value = "";
  cidadeEl.disabled = true;

  const lista = ESTADOS[paisEl.value];

  if (!lista) return;

  lista.forEach(([valor, nome]) => {
    const opt = document.createElement("option");
    opt.value = valor;
    opt.textContent = nome;
    estadoEl.appendChild(opt);
  
  });

    const optOutroEstado = document.createElement("option");
    optOutroEstado.value = "OUTRO";
    optOutroEstado.textContent = "OUTRO";
    estadoEl.appendChild(optOutroEstado);

   
  estadoEl.disabled = false;
};




  
 
estadoEl.onchange = () => {
  // reset estado outro
  estadoOutroEl.style.display = "none";
  estadoOutroEl.value = "";

  // reset cidade (SEM FOR√áAR OUTRA)
  cidadeEl.innerHTML = `<option value="">Cidade</option>`;
  cidadeEl.disabled = true;
  cidadeOutraEl.style.display = "none";
  cidadeOutraEl.value = "";

  if (!estadoEl.value) return;

  // üü° ESTADO = OUTRO ‚Üí s√≥ abre o campo de estado
  if (estadoEl.value === "OUTRO") {
    estadoOutroEl.style.display = "block";
    estadoOutroEl.focus();

    // cidade fica dispon√≠vel, mas neutra
    cidadeEl.disabled = false;

    const optOutra = document.createElement("option");
    optOutra.value = "OUTRA";
    optOutra.textContent = "OUTRA";
    cidadeEl.appendChild(optOutra);

    return;
  }

  // üü¢ ESTADO NORMAL ‚Üí carrega cidades
  const listaCidades = CIDADES[paisEl.value]?.[estadoEl.value];

  if (listaCidades) {
    listaCidades.forEach(cidade => {
      const opt = document.createElement("option");
      opt.value = cidade;
      opt.textContent = cidade;
      cidadeEl.appendChild(opt);
    });
  }

  // adiciona OUTRA como op√ß√£o
  const optOutra = document.createElement("option");
  optOutra.value = "OUTRA";
  optOutra.textContent = "OUTRA";
  cidadeEl.appendChild(optOutra);

  cidadeEl.disabled = false;
};


cidadeEl.onchange = () => {
  if (cidadeEl.value === "OUTRA") {
    cidadeOutraEl.style.display = "block";
    cidadeOutraEl.focus();
  } else {
    cidadeOutraEl.style.display = "none";
    cidadeOutraEl.value = "";
  }
};



  
   
function finalizar() {

const chaveCurso = `${CURSO_FIXO.trim()}__${TURMA_FIXA.trim()}`;

console.log("üîé CHAVE ESPERADA:", chaveCurso);
console.log("üì¶ CHAVES DISPON√çVEIS:", Object.keys(CURSOS_MAPA));

  

// üîí VALIDA CURSO + TURMA
if (!CURSOS_MAPA[chaveCurso]) {
  console.error("Curso/turma n√£o encontrada:", chaveCurso);
  alert("Curso indispon√≠vel no momento. Entre em contato com a organiza√ß√£o.");
  return;
}

const cursoSelecionado = CURSOS_MAPA[chaveCurso];


  

// üî¥ VALIDA NOME (OBRIGAT√ìRIO)
  
 if (!nomeEl.value.trim()) {
  alert("‚ö†Ô∏è Informe o nome do participante.");
  nomeEl.classList.add("erro");
  nomeEl.focus();
  return;
} else {
  nomeEl.classList.remove("erro");
}
  
  
  
  
  // üî¥ VALIDA EMAIL (OBRIGAT√ìRIO)
if (!emailEl.value.trim()) {
  alert("‚ö†Ô∏è Informe o e-mail.");
  emailEl.classList.add("erro");
  emailEl.focus();
  return;
}

if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(emailEl.value)) {
  alert("‚ö†Ô∏è Informe um e-mail v√°lido.");
  emailEl.classList.add("erro");
  emailEl.focus();
  return;
} else {
  emailEl.classList.remove("erro");
}
  
  
    
  
  // üî¥ VALIDA TELEFONE (OBRIGAT√ìRIO)
if (!telefoneEl.value.trim()) {
  alert("‚ö†Ô∏è Informe o telefone / WhatsApp.");
  telefoneEl.classList.add("erro");
  telefoneEl.focus();
  return;
}

// m√≠nimo 10 d√≠gitos (DDD + n√∫mero)
if (telefoneEl.value.length < 10) {
  alert("‚ö†Ô∏è Informe um telefone v√°lido com DDD.");
  telefoneEl.classList.add("erro");
  telefoneEl.focus();
  return;
} else {
  telefoneEl.classList.remove("erro");
} 


  
  
// üî¥ VALIDA PA√çS
if (!paisEl.value) {
  alert("‚ö†Ô∏è Selecione o pa√≠s.");
  paisEl.focus();
  return;
}

// üî¥ VALIDA ESTADO / PREFEITURA / DEPARTAMENTO
if (
  !estadoEl.value ||
  (estadoEl.value === "OUTRO" && !estadoOutroEl.value.trim())
) {
  alert("‚ö†Ô∏è Informe o estado / regi√£o.");
  estadoEl.focus();
  return;
}

// üî¥ VALIDA CIDADE
if (
  !cidadeEl.value ||
  (cidadeEl.value === "OUTRA" && !cidadeOutraEl.value.trim())
) {
  alert("‚ö†Ô∏è Informe a cidade.");
  cidadeEl.classList.add("erro");
  cidadeEl.focus();
  return;
} else {
  cidadeEl.classList.remove("erro");
}



  
  if (document.querySelector(".erro")) {
    alert("‚ö†Ô∏è Corrija os campos destacados.");
    return;
  }

  // üîí IN√çCIO DO SALVAMENTO
btnConfirmar.innerText = "Registrando no sistema...";
btnConfirmar.disabled = true;
btnConfirmar.style.opacity = "0.7";
btnConfirmar.style.cursor = "not-allowed";

/* ‚úÖ AQUI √â A CORRE√á√ÉO */
const cidadeFinal =
  cidadeEl.value === "OUTRA"
    ? cidadeOutraEl.value.toUpperCase()
    : cidadeEl.value.toUpperCase();

const estadoFinal =
  estadoEl.value === "OUTRO"
    ? estadoOutroEl.value.toUpperCase()
    : estadoEl.value;

/* üîΩ AGORA SIM O FETCH */
fetch(ENDPOINT, {
  method: "POST",
  body: JSON.stringify({
    cpf: cpfEl.value.replace(/\D/g, ''),
    nome: nomeEl.value.toUpperCase(),
    email: emailEl.value.toLowerCase(),
    telefone: telefoneEl.value,

    nomeCurso: cursoSelecionado.nome,
    turma: cursoSelecionado.turma || "",

    cargaHoraria: cursoSelecionado.carga || "",
    localCurso: cursoSelecionado.local || "",
    dataHorarioCurso: cursoSelecionado.data || "",

    cidade: cidadeFinal,
    estado: estadoFinal,

    token: cursoSelecionado.token || ""
  })
})
.then(r => r.text())
.then(txt => {
  const res = JSON.parse(txt);

  if (!res.sucesso) {
    alert("Erro ao registrar a pr√©-inscri√ß√£o.");
    btnConfirmar.disabled = false;
    btnConfirmar.innerText = "CONFIRMAR INSCRI√á√ÉO";
    return;
  }

  
  
  document.body.innerHTML = `
    <div style="
      font-family: Arial, sans-serif;
      background: #f4f6f8;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    ">
      <div style="
        background: #fff;
        padding: 30px;
        border-radius: 12px;
        max-width: 460px;
        width: 100%;
        box-shadow: 0 8px 20px rgba(0,0,0,.1);
      ">

        <h2 style="color:#1f3c88; text-align:center;">
          üìù Pr√©-Inscri√ß√£o registrada!
        </h2>

        <p style="margin-top:15px; font-size:15px; text-align:center;">
          
        
        <hr style="margin:20px 0;">

        <h3 style="color:#1f3c88;">Dados da sua pr√©-inscri√ß√£o</h3>

        <div class="dados-inscricao">
        <p><b>Participante:</b> ${nomeEl.value}</p>
        <p><b>E-mail:</b> ${emailEl.value.toLowerCase()}</p>
        <p><b>Curso:</b> ${cursoSelecionado.nome}</p>
        <p><b>Turma:</b> ${cursoSelecionado.turma || "-"}</p>
        <p><b>Carga hor√°ria:</b> ${cursoSelecionado.carga || "-"}</p>
        <p><b>Local:</b> ${cursoSelecionado.local || "-"}</p>
        <p><b>Dia(s):</b> ${cursoSelecionado.data || "-"}</p>
        </div>
        
        <b>Aten√ß√£o:</b> o acesso aos materiais, apostilas e voucher ser√° enviado somente ap√≥s a confirma√ß√£o do pagamento</b>.
        </p>

        <hr style="margin:20px 0;">

        

        <a href="${LINK_PAGAMENTO}" target="_blank"
           style="
             display:block;
             margin-top:15px;
             padding:14px;
             background:#2f55d4;
             color:#fff;
             text-decoration:none;
             border-radius:10px;
             font-weight:bold;
             text-align:center;
           ">
          REALIZAR PAGAMENTO
        </a>

          
        <p style="margin-top:20px; color:#000000;  font-size:15px; text-align:left;">
        <b> üî¥ IMPORTANTE!!!</b>
        </P>

        <p style="font-size:15px; text-align:left;">
          üëâ Para confirmar sua vaga, clique no bot√£o acima e realize o pagamento:
        </p>
        
        <p style="font-size:15px; text-align:left;">
          üö® Ap√≥s pagar, envie o comprovante pelo WhatsApp (18) 99122-1171 <a href="https://wa.me/5518991221171" target="_blank" style="color:#25D366; font-weight:bold; text-decoration:none;"> üü¢ Clicando Aqui </a> ou fale diretamente com o consultor que est√° te atendendo.<br><br> 
          
          üëâ Assim que nosso time confirmar o comprovante, voc√™ receber√° de <b>igctreinamentoscorporativo@gmail.com</b>:<br><br>

          ‚Ä¢ E-mail de inscri√ß√£o confirmada<br>
          ‚Ä¢ Voucher para ingresso no evento<br>
          ‚Ä¢ Apostilas e materiais completos em PDF<br><br>
                    
          Nos vemos em breve! üôå </p>
      </div>
    </div>
  `;
});

}
  
</script>
 </body>
</html>
